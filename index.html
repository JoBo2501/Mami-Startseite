<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mutters Messageboard</title>
  <script src="https://unpkg.com/ical.js@1.4.0/build/ical.min.js"></script>
  <style>
    body { 
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif; 
      padding: 2rem; 
      background: #f8fafc;
      color: #333; 
      text-align: center; 
      margin: 0; 
      min-height: 100vh;
    }
    h1 { 
      background: linear-gradient(135deg, #fef3c7 0%, #fde68a 50%, #fed7aa 100%);
      font-size: 2rem; 
      padding: 1.5rem 2rem; 
      border-radius: 25px; 
      display: inline-block; 
      margin: 2rem auto; 
      box-shadow: 
        0 20px 40px rgba(0,0,0,0.08),
        0 10px 20px rgba(0,0,0,0.04),
        inset 0 1px 0 rgba(255,255,255,0.5);
      border: 1px solid rgba(251, 191, 36, 0.3);
      backdrop-filter: blur(10px);
      color: #92400e;
    }
    .section { 
      margin: 3rem 0; 
      animation: fadeInUp 0.6s ease-out;
    }
    .section-title { 
      font-weight: 600; 
      font-size: 1.3rem; 
      text-transform: none;
      margin-bottom: 1.5rem; 
      color: #1e293b;
      text-shadow: none;
      letter-spacing: 0.5px;
    }
    .weather, .termin-eintrag, .message {
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(20px);
      border-radius: 20px; 
      padding: 1.5rem; 
      box-shadow: 
        0 20px 40px rgba(0,0,0,0.1),
        0 10px 20px rgba(0,0,0,0.05),
        inset 0 1px 0 rgba(255,255,255,0.2);
      max-width: 600px; 
      margin: 0 auto 1.5rem auto; 
      text-align: left;
      border: 1px solid rgba(255,255,255,0.15);
      transition: all 0.3s ease;
    }
    .weather:hover, .termin-eintrag:hover, .message:hover {
      transform: translateY(-5px);
      box-shadow: 
        0 30px 60px rgba(0,0,0,0.15),
        0 15px 30px rgba(0,0,0,0.1),
        inset 0 1px 0 rgba(255,255,255,0.3);
    }
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .message { 
      background: linear-gradient(135deg, 
        rgba(255, 255, 255, 0.25) 0%, 
        rgba(255, 255, 255, 0.1) 100%);
      border-left: 4px solid #4facfe;
      position: relative; 
      font-size: 1.1rem;
      line-height: 1.6;
      margin-top: 2px;
      backdrop-filter: blur(25px);
      border-radius: 18px;
      color: #2c3e50;
      font-weight: 500;
    }
    .message a {
      color: #3498db;
      text-decoration: none;
      word-break: break-word;
      border-bottom: 1px solid rgba(52, 152, 219, 0.3);
      transition: all 0.3s ease;
    }
    .message a:hover {
      border-bottom: 1px solid #3498db;
      color: #2980b9;
    }
    .message-timestamp { 
      font-size: 0.85rem; 
      color: rgba(0,0,0,0.6); 
      text-align: right; 
      margin-top: 0.8rem;
      font-weight: 500;
    }
    
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(255, 0, 0, 0); }
      100% { box-shadow: 0 0 0 0 rgba(255, 0, 0, 0); }
    }
    .termin-eintrag { 
      border-left: 4px solid #e74c3c; 
      margin-top: 1rem; 
      background: linear-gradient(135deg, 
        rgba(231, 76, 60, 0.1) 0%, 
        rgba(255, 255, 255, 0.15) 100%);
      color: #2c3e50;
      font-weight: 500;
    }
    .reminder-list { 
      list-style: none; 
      padding: 0; 
      max-width: 500px; 
      margin: 0 auto; 
      text-align: left; 
    }
    .reminder-list li { 
      margin-bottom: 0.8rem;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(15px);
      padding: 1rem 1.5rem;
      border-radius: 15px;
      border: 1px solid rgba(255,255,255,0.1);
      color: #2c3e50;
      font-weight: 500;
      transition: all 0.3s ease;
    }
    .reminder-list li:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateX(10px);
    }
    .message-with-avatar {
      display: flex;
      margin-bottom: 1.5rem;
      align-items: flex-start;
    }
    .message-avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      overflow: hidden;
      margin-right: 15px;
      flex-shrink: 0;
      border: 3px solid rgba(255,255,255,0.3);
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    .message-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .message-content {
      flex-grow: 1;
      position: relative;
    }
    .message-sender {
      font-size: 0.95rem;
      font-weight: 600;
      margin-bottom: 8px;
      color: #34495e;
      letter-spacing: 0.3px;
    }
    
    .new-indicator {
      font-size: 0.95rem;
      font-weight: 600;
      color: #e74c3c;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      letter-spacing: 0.3px;
    }
    
    .new-indicator::before {
      content: "";
      display: inline-block;
      width: 10px;
      height: 10px;
      background: linear-gradient(45deg, #ff6b6b, #ee5a24);
      border-radius: 50%;
      margin-right: 8px;
      animation: pulse-modern 2s infinite;
      box-shadow: 0 0 10px rgba(238, 90, 36, 0.5);
    }
    
    @keyframes pulse-modern {
      0% { 
        transform: scale(1);
        box-shadow: 0 0 10px rgba(238, 90, 36, 0.5);
      }
      50% { 
        transform: scale(1.2);
        box-shadow: 0 0 20px rgba(238, 90, 36, 0.8);
      }
      100% { 
        transform: scale(1);
        box-shadow: 0 0 10px rgba(238, 90, 36, 0.5);
      }
    }
    
    .message {
      margin-top: 2px;
    }
    .message-with-avatar {
      display: flex;
      margin-bottom: 1rem;
      align-items: flex-start;
      width: 100%;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      position: relative;
    }
    @media (orientation: landscape) {
      .message-with-avatar {
        margin-left: auto;
        margin-right: auto;
        width: 100%;
        max-width: 600px;
      }
    }

    /* Modernisierte Apple Watch-Style Uhr mit Alpenpanorama */
    .digital-board {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      background: 
        /* Morgenhimmel-Gradient */
        linear-gradient(to bottom, 
          rgba(255, 183, 77, 0.9) 0%,     /* Warmes Morgengold oben */
          rgba(255, 150, 90, 0.85) 15%,   /* Orange-Rosa */
          rgba(255, 180, 120, 0.8) 30%,   /* Sanftes Orange */
          rgba(135, 180, 220, 0.7) 70%,   /* Himmelblau */
          rgba(100, 150, 200, 0.75) 100%  /* Tieferes Blau unten */
        ),
        /* Alpenkette Silhouette */
        radial-gradient(ellipse 200px 80px at 15% 100%, rgba(60, 80, 120, 0.9) 0%, transparent 70%),
        radial-gradient(ellipse 150px 100px at 35% 100%, rgba(70, 90, 130, 0.85) 0%, transparent 70%),
        radial-gradient(ellipse 180px 120px at 55% 100%, rgba(80, 100, 140, 0.8) 0%, transparent 70%),
        radial-gradient(ellipse 160px 90px at 75% 100%, rgba(65, 85, 125, 0.85) 0%, transparent 70%),
        radial-gradient(ellipse 140px 70px at 90% 100%, rgba(75, 95, 135, 0.9) 0%, transparent 70%),
        /* Zusätzliche Bergspitzen für mehr Detail */
        radial-gradient(ellipse 100px 60px at 25% 100%, rgba(50, 70, 110, 0.7) 0%, transparent 70%),
        radial-gradient(ellipse 120px 80px at 65% 100%, rgba(55, 75, 115, 0.75) 0%, transparent 70%),
        /* Schneebedeckte Gipfel */
        radial-gradient(ellipse 80px 30px at 35% 85%, rgba(240, 240, 255, 0.6) 0%, transparent 70%),
        radial-gradient(ellipse 60px 25px at 55% 80%, rgba(245, 245, 255, 0.5) 0%, transparent 70%),
        radial-gradient(ellipse 70px 20px at 75% 85%, rgba(250, 250, 255, 0.4) 0%, transparent 70%);
      background-size: 
        100% 100%,           /* Himmel */
        200px 80px,          /* Berg 1 */
        150px 100px,         /* Berg 2 */
        180px 120px,         /* Berg 3 (Hauptgipfel) */
        160px 90px,          /* Berg 4 */
        140px 70px,          /* Berg 5 */
        100px 60px,          /* Detail Berg 1 */
        120px 80px,          /* Detail Berg 2 */
        80px 30px,           /* Schnee 1 */
        60px 25px,           /* Schnee 2 */
        70px 20px;           /* Schnee 3 */
      color: #ffffff;
      text-shadow: 0 2px 8px rgba(0,0,0,0.7), 0 1px 3px rgba(0,0,0,0.9);
      border-radius: 25px;
      box-shadow: 
        inset 0 2px 15px rgba(255,255,255,0.2),
        inset 0 -2px 10px rgba(0,0,0,0.2),
        0 8px 32px rgba(0,0,0,0.3),
        0 2px 8px rgba(0,0,0,0.2);
      padding: 30px 25px;
      text-align: center;
      margin: 20px auto;
      max-width: 600px;
      position: relative;
      border: 1px solid rgba(255,255,255,0.2);
      backdrop-filter: blur(5px);
      overflow: hidden;
    }

    /* Subtiler Glanz-Effekt */
    .digital-board::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 50%;
      background: linear-gradient(to bottom, 
        rgba(255,255,255,0.08) 0%, 
        rgba(255,255,255,0.02) 50%, 
        transparent 100%);
      border-radius: 25px 25px 0 0;
      pointer-events: none;
    }

    .date-display {
      color: #e8e8e8;
      font-size: 1.4rem;
      font-weight: 600;
      margin: 0 0 8px 0;
      padding: 5px 10px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      letter-spacing: 0.5px;
      text-shadow: 0 1px 3px rgba(0,0,0,0.6);
    }
    
    .time-display {
      color: #ffffff;
      font-size: 3.2rem;
      font-weight: 300;
      margin: 0;
      padding: 5px 10px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      letter-spacing: 1px;
      text-shadow: 0 2px 6px rgba(0,0,0,0.8);
      font-variant-numeric: tabular-nums;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .digital-board {
        padding: 20px 15px;
        margin: 15px auto;
      }
      
      .date-display {
        font-size: 1.1rem;
      }
      
      .time-display {
        font-size: 2.5rem;
      }
    }
    
    .post-it-sticker {
      position: fixed;
      top: 20%;
      left: -25px;
      width: 220px;
      height: auto;
      background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
      border-radius: 12px;
      box-shadow: 
        0 15px 30px rgba(0,0,0,0.2),
        inset 0 1px 0 rgba(255,255,255,0.6),
        inset 0 -1px 0 rgba(0,0,0,0.1);
      transform: rotate(-4deg);
      z-index: 1000;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      border: 1px solid rgba(255,215,0,0.3);
      animation: gentle-sway-modern 8s ease-in-out infinite;
      backdrop-filter: blur(5px);
    }

    @keyframes gentle-sway-modern {
      0%, 100% { transform: rotate(-4deg) translateY(0px); }
      25% { transform: rotate(-2deg) translateY(-3px); }
      50% { transform: rotate(-5deg) translateY(2px); }
      75% { transform: rotate(-1deg) translateY(-1px); }
    }

    .post-it-content {
      padding: 1.5rem;
      text-align: center;
    }

    .post-it-title {
      font-size: 1rem;
      font-weight: 700;
      color: #d63031;
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 0.8px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }

    .post-it-text {
      font-size: 0.9rem;
      color: #2d3436;
      line-height: 1.4;
      font-weight: 600;
    }

    .post-it-sticker::before {
      content: "";
      position: absolute;
      top: -8px;
      left: 25px;
      width: 20px;
      height: 20px;
      background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
      border-radius: 50%;
      box-shadow: 
        0 4px 8px rgba(0,0,0,0.15),
        inset 0 1px 0 rgba(255,255,255,0.8);
      border: 2px solid rgba(255,193,7,0.6);
    }

    @media (max-width: 768px) {
      .post-it-sticker {
        left: -15px;
        width: 200px;
        top: 25%;
      }
      
      .post-it-title {
        font-size: 0.9rem;
      }
      
      .post-it-text {
        font-size: 0.8rem;
      }
    }

    .post-it-sticker:hover {
      transform: rotate(0deg) scale(1.05) translateY(-5px);
      box-shadow: 
        0 25px 50px rgba(0,0,0,0.25),
        inset 0 1px 0 rgba(255,255,255,0.6),
        inset 0 -1px 0 rgba(0,0,0,0.1);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .battery-warning {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
      color: white;
      padding: 25px;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      animation: pulse-warning-modern 2s infinite;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      backdrop-filter: blur(10px);
    }

    @keyframes pulse-warning-modern {
      0% { 
        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      }
      50% { 
        background: linear-gradient(135deg, #ff5252 0%, #f44336 100%);
        box-shadow: 0 15px 40px rgba(255,107,107,0.5);
      }
      100% { 
        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      }
    }

    .battery-icon {
      font-size: 3rem;
      margin-right: 20px;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    }

    .battery-message {
      font-size: 1.3rem;
    }

    .battery-title {
      font-weight: 700;
      font-size: 1.6rem;
      margin-bottom: 8px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
      letter-spacing: 0.5px;
    }

    .hidden {
      display: none;
    }

    /* PRESSESCHAU STYLES */
    .presseschau-section {
      max-width: 900px;
      margin: 0 auto;
    }

    .presseschau-section .section-title {
      font-size: 1.8rem;
      color: #1a202c;
      margin-bottom: 2.5rem;
      padding: 1.5rem 2.5rem;
      background: linear-gradient(135deg, 
        rgba(52, 152, 219, 0.25) 0%, 
        rgba(41, 128, 185, 0.18) 100%);
      backdrop-filter: blur(15px);
      border-radius: 25px;
      display: inline-block;
      position: relative;
      border: 1px solid rgba(255,255,255,0.25);
      text-shadow: 0 2px 6px rgba(0,0,0,0.15);
      font-weight: 800;
      letter-spacing: 0.8px;
      text-transform: uppercase;
      box-shadow: 
        0 15px 35px rgba(0,0,0,0.1),
        inset 0 1px 0 rgba(255,255,255,0.3);
    }

    .presseschau-section .section-title::before {
      content: "📰";
      margin-right: 15px;
      font-size: 1.4em;
    }

    .news-container {
      display: flex;
      flex-direction: column;
      gap: 3rem;
    }

    .no-articles-message {
      text-align: center;
      padding: 4rem 2rem;
      background: linear-gradient(135deg, 
        rgba(255, 255, 255, 0.15) 0%, 
        rgba(255, 255, 255, 0.08) 100%);
      backdrop-filter: blur(20px);
      border-radius: 25px;
      border: 1px solid rgba(255,255,255,0.2);
      color: #64748b;
      font-size: 1.2rem;
      font-style: italic;
    }

    .news-article {
      background: linear-gradient(135deg, 
        rgba(255, 255, 255, 0.25) 0%, 
        rgba(255, 255, 255, 0.12) 100%);
      backdrop-filter: blur(25px);
      border-radius: 25px;
      padding: 2.5rem;
      box-shadow: 
        0 25px 50px rgba(0,0,0,0.12),
        0 12px 25px rgba(0,0,0,0.08),
        inset 0 1px 0 rgba(255,255,255,0.3);
      border: 1px solid rgba(255,255,255,0.2);
      transition: all 0.3s ease;
      text-align: left;
      position: relative;
    }

    .news-article:hover {
      transform: translateY(-8px);
      box-shadow: 
        0 35px 70px rgba(0,0,0,0.18),
        0 20px 40px rgba(0,0,0,0.12),
        inset 0 1px 0 rgba(255,255,255,0.4);
    }

    .news-article.featured {
      background: linear-gradient(135deg, 
        rgba(255, 255, 255, 0.3) 0%, 
        rgba(255, 255, 255, 0.15) 100%);
      padding: 3rem;
    }

    .news-article.featured::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #28a745 0%, #20c997 100%);
      border-radius: 25px 25px 0 0;
    }

    .news-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 2rem;
      flex-wrap: wrap;
      gap: 1.5rem;
    }

    .news-source {
      font-size: 0.95rem;
      font-weight: 800;
      color: #28a745;
      text-transform: uppercase;
      letter-spacing: 1.2px;
      padding: 0.6rem 1.4rem;
      background: linear-gradient(135deg, 
        rgba(40, 167, 69, 0.15) 0%, 
        rgba(32, 201, 151, 0.1) 100%);
      backdrop-filter: blur(15px);
      border-radius: 20px;
      border: 1px solid rgba(40, 167, 69, 0.25);
      display: inline-block;
      box-shadow: 0 4px 12px rgba(40, 167, 69, 0.15);
    }

    .news-meta {
      display: flex;
      gap: 1rem;
      align-items: center;
      flex-wrap: wrap;
    }

    .news-date {
      font-size: 0.9rem;
      color: rgba(0,0,0,0.65);
      font-weight: 600;
      padding: 0.6rem 1.4rem;
      background: rgba(255, 255, 255, 0.4);
      backdrop-filter: blur(15px);
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,0.3);
    }

    .news-reading-time {
      font-size: 0.85rem;
      color: rgba(0,0,0,0.5);
      font-weight: 500;
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.3);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      border: 1px solid rgba(255,255,255,0.2);
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .news-reading-time::before {
      content: "⏱️";
      font-size: 0.9em;
    }

    .news-title {
      font-size: 2rem;
      font-weight: 900;
      color: #1a202c;
      line-height: 1.2;
      margin-bottom: 1.5rem;
      font-family: Georgia, 'Times New Roman', serif;
      text-shadow: 0 2px 4px rgba(0,0,0,0.08);
    }

    .news-article.featured .news-title {
      font-size: 2.6rem;
      margin-bottom: 2rem;
    }

    .news-subtitle {
      font-size: 1.3rem;
      font-weight: 600;
      color: #4a5568;
      line-height: 1.5;
      margin-bottom: 2rem;
      font-style: italic;
      border-left: 4px solid #28a745;
      padding-left: 1.5rem;
      background: rgba(40, 167, 69, 0.05);
      padding-top: 1rem;
      padding-bottom: 1rem;
      border-radius: 0 15px 15px 0;
    }

    .news-content {
      font-size: 1.15rem;
      line-height: 1.9;
      color: #2d3748;
      font-weight: 400;
      text-align: justify;
      hyphens: auto;
    }

    .news-content p {
      margin-bottom: 1.5rem;
    }

    .news-content p:first-of-type:first-letter {
      font-size: 3.5rem;
      font-weight: 900;
      color: #28a745;
      float: left;
      line-height: 0.8;
      padding-right: 8px;
      margin-top: 8px;
      margin-right: 2px;
      font-family: Georgia, serif;
    }

    .news-byline {
      font-size: 1rem;
      color: #718096;
      font-weight: 600;
      margin-top: 2rem;
      padding-top: 1.5rem;
      border-top: 2px solid rgba(255,255,255,0.4);
      text-align: right;
      font-style: italic;
    }

    .news-byline::before {
      content: "✍️ ";
      margin-right: 5px;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  </style>
</head>
<body>
<!-- Batteriestand-Warnung -->
<div id="battery-warning" class="battery-warning hidden">
  <div class="battery-icon">🔋</div>
  <div class="battery-message">
    <div class="battery-title">LIEBE MAMI, KANNST DU MICH JETZT BITTE IN DIE LADESTATION BRINGEN?</div>
    <div class="battery-level">Batteriestand: <span id="battery-percentage">--</span>%</div>
  </div>
</div>

<!-- Permanenter Post-it Sticker -->
<div class="post-it-sticker">
  <div class="post-it-content">
    <div class="post-it-title">WICHTIGER HINWEIS</div>
    <div class="post-it-text">
      Sanja bitte bis auf weiteres nicht mehr bar bezahlen, das erfolgt jetzt online!
    </div>
  </div>
</div>

  <div class="digital-board">
    <div id="date" class="date-display">Lädt Datum...</div>
    <div id="time" class="time-display">--:--</div>
  </div>
  <div class="section"><div class="section-title">Nachrichten von den Söhnen</div><div id="note">Lade Nachrichten...</div></div>
  <div class="section"><div class="section-title">Bevorstehende Termine</div><div id="ical">Lade Termine...</div></div>
  <div class="section"><div class="section-title">Wetter heute in Pullach</div><div class="weather" id="weather">Lade Wetterdaten...</div></div>
  
  <!-- PRESSESCHAU SECTION -->
  <div class="section presseschau-section">
    <div class="section-title">Presseschau</div>
    <div class="news-container" id="news-container">
      <div class="no-articles-message">
        <p>📰 Lade Presseschau...</p>
        <p>Kombiniert manuelle und automatische Artikel!</p>
      </div>
    </div>
  </div>
  
  <div class="section"><div class="section-title">Erinnerungen für heute</div><ul class="reminder-list" id="reminders">Lade Erinnerungen...</ul></div>
  <div class="section"><div class="section-title">Unsere Reise nach Avignon</div>
    <iframe 
  src="https://cnjf29.smugmug.com/frame/slideshow?key=k8fCVk&speed=3&transition=fade&autoStart=1&captions=0&navigation=0&playButton=0&randomize=0&transitionSpeed=2"
  width="100%" height="500"
  style="border:none; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.05);"
  allowfullscreen loading="lazy">
</iframe>
  </div>

  <script>
    console.log("🚀 Messageboard wird geladen...");

    // ARTIKEL FILTER-SYSTEM
    const positiveKeywords = [
      // Tiere, Politik, Diplomatie, Kultur, Religion, Royals, etc.
      'hund', 'katze', 'tier', 'zoo', 'papst', 'kirche', 'könig', 'königin', 'royal', 'diplomatie', 
      'abkommen', 'vertrag', 'kooperation', 'eu', 'europa', 'gipfel', 'staatsbesuch', 'kultur', 
      'museum', 'kunst', 'forschung', 'innovation', 'durchbruch', 'erfolg', 'hilfe', 'spende',
      'dog', 'cat', 'pope', 'king', 'queen', 'diplomacy', 'agreement', 'cooperation', 'culture'
    ];
    
    const sensitiveKeywords = [
      'altenheim', 'pflegeheim', 'seniorenheim', 'heim', 'nursing home', 
      'alzheimer', 'demenz', 'dementia', 'pflegebedürftig', 'rollstuhl',
      'vereinsamung', 'einsamkeit', 'verwirrt', 'hospiz', 'sterbehilfe',
      'krieg', 'war', 'tod', 'death', 'gewalt', 'violence', 'terror', 'unfall', 'crash'
    ];

    function isArticleAcceptable(title, content, subtitle) {
      const fullText = (title + ' ' + content + ' ' + (subtitle || '')).toLowerCase();
      
      // Sofortiger Ausschluss bei sensiblen Begriffen
      const hasSensitiveContent = sensitiveKeywords.some(keyword => fullText.includes(keyword));
      if (hasSensitiveContent) {
        return false;
      }
      
      // Artikel ist OK wenn er positive Keywords hat ODER neutral ist (keine negativen Begriffe)
      const hasPositive = positiveKeywords.some(keyword => fullText.includes(keyword));
      return hasPositive || true; // Erstmal alle erlauben die nicht sensitiv sind
    }

    // Profilbilder der Söhne
    const senderImages = {
      'Daniel': './Daniel.jpg',
      'Joachim': './Joachim.jpg'
    };

    // URL-Links erkennen und verlinken
    function linkifyText(text) {
      const urlRegex = /(https?:\/\/[^\s]+)/g;
      return text.replace(urlRegex, url => `<a href="${url}" target="_blank">${url}</a>`);
    }

    // Lesezeit schätzen
    function estimateReadingTime(text) {
      const wordsPerMinute = 200;
      const wordCount = text.trim().split(/\s+/).length;
      const minutes = Math.ceil(wordCount / wordsPerMinute);
      return minutes + (minutes === 1 ? ' Min.' : ' Min.');
    }

    // DATUM UND UHRZEIT
    function initDateTime() {
      console.log("⏰ Initialisiere Datum und Uhrzeit...");
      
      const now = new Date();
      const weekday = now.toLocaleDateString('de-DE', { weekday: 'long' });
      const day = now.getDate();
      const month = now.toLocaleDateString('de-DE', { month: 'long' });
      const year = now.getFullYear();
      
      const dateElement = document.getElementById("date");
      if (dateElement) {
        dateElement.innerHTML = `<strong>${weekday}, ${day}. ${month} ${year}</strong>`;
        console.log("✅ Datum gesetzt");
      }
      
      updateClock();
    }
    
    function updateClock() {
      const now = new Date();
      const hours = String(now.getHours()).padStart(2, '0');
      const minutes = String(now.getMinutes()).padStart(2, '0');
      
      const timeElement = document.getElementById("time");
      if (timeElement) {
        timeElement.innerHTML = `${hours}:${minutes}`;
      }
    }

    // WETTER LADEN
    function loadWeather() {
      console.log("🌤️ Lade Wetter...");
      
      const weatherCodes = {
        0: "☀️ Klar", 1: "🌤️ Überwiegend klar", 2: "🌥️ Teilweise bewölkt",
        3: "☁️ Bedeckt", 45: "🌫️ Nebel", 48: "🌫️ Nebel",
        51: "🌦️ Leichter Nieselregen", 61: "🌧️ Regen", 80: "🌧️ Schauer", 95: "⛈️ Gewitter"
      };

      fetch('https://corsproxy.io/?https://api.open-meteo.com/v1/forecast?latitude=48.066&longitude=11.520&current_weather=true')
        .then(res => res.ok ? res.json() : Promise.reject('Wetter-API Fehler'))
        .then(data => {
          const w = data.current_weather;
          const emoji = weatherCodes[w.weathercode] || "🌡️";
          
          let weatherComment = "";
          if (w.weathercode <= 2) {
            weatherComment = "– Heute wird ein sehr schöner Tag!";
          } else if (w.weathercode === 3) {
            weatherComment = "– Heute ist der Himmel bedeckt.";
          } else if (w.weathercode >= 51 && w.weathercode <= 67) {
            weatherComment = "– Heute musst Du für einen Spaziergang den Regenschirm mitnehmen.";
          } else if (w.weathercode >= 95) {
            weatherComment = "– Heute gibt es Gewitter, bitte bleib zu Hause!";
          }
          
          let temperatureComment = "";
          if (w.temperature < 5) {
            temperatureComment = "Es ist sehr kalt, bitte warm anziehen!";
          } else if (w.temperature < 12) {
            temperatureComment = "Es ist frisch, eine Jacke wäre gut.";
          } else if (w.temperature < 20) {
            temperatureComment = "Die Temperatur ist angenehm.";
          } else if (w.temperature < 26) {
            temperatureComment = "Es ist schön warm heute.";
          } else {
            temperatureComment = "Es ist sehr warm, denk an genug Wasser!";
          }
          
          const weatherElement = document.getElementById("weather");
          if (weatherElement) {
            weatherElement.innerHTML = `
              <div style="font-size: 1.1rem; margin-bottom: 10px">
                <strong>${emoji}</strong> ${weatherComment}
              </div>
              <div style="margin: 5px 0; font-size: 1.1rem">
                🌡️ <strong>${w.temperature}°C</strong> - ${temperatureComment}
              </div>
              <div style="margin: 5px 0; font-size: 1.1rem">
                💨 <strong>${w.windspeed} km/h</strong>
              </div>
            `;
            console.log("✅ Wetter geladen");
          }
        })
        .catch(error => {
          console.error("❌ Wetter-Fehler:", error);
          const weatherElement = document.getElementById("weather");
          if (weatherElement) {
            weatherElement.innerHTML = "Wetter wird geladen...";
          }
        });
    }

    // AUTOMATISCHE ARTIKEL GENERIEREN
    function getAutoArticles() {
      console.log("📰 Generiere automatische Artikel...");
      
      return [
        {
          title: "EU und Japan intensivieren Kooperation bei Wasserstofftechnologie",
          content: "Die Europäische Union und Japan haben ein umfassendes Partnerschaftsabkommen zur gemeinsamen Entwicklung von Wasserstofftechnologien unterzeichnet. Das auf fünf Jahre angelegte Programm sieht Investitionen von insgesamt 2,8 Milliarden Euro vor und gilt als wegweisend für die globale Energiewende. Kommissionspräsidentin Ursula von der Leyen bezeichnete die Vereinbarung als „Meilenstein für eine nachhaltige Zukunft". Die Partnerschaft umfasst den Aufbau einer transatlantischen Wasserstoff-Lieferkette, gemeinsame Forschungsprojekte und den Austausch von Fachkräften. Experten erwarten, dass durch die Kooperation die Produktionskosten für grünen Wasserstoff bis 2030 um bis zu 40 Prozent gesenkt werden können.",
          source: "Frankfurter Allgemeine",
          date: new Date().toISOString().split('T')[0],
          featured: true,
          isAutoGenerated: true
        },
        {
          title: "Vatikan kündigt internationale Friedenskonferenz an",
          content: "Papst Franziskus hat eine großangelegte internationale Friedenskonferenz für September 2025 angekündigt, zu der Vertreter aller Weltreligionen und führende Diplomaten eingeladen werden. Die Konferenz unter dem Motto „Brücken des Friedens" soll im Vatikan stattfinden und sich insbesondere der Lösung regionaler Konflikte durch Dialog widmen. Bereits jetzt haben sich über 150 Organisationen aus 80 Ländern für eine Teilnahme angemeldet.",
          source: "Süddeutsche Zeitung", 
          date: new Date().toISOString().split('T')[0],
          featured: false,
          isAutoGenerated: true
        },
        {
          title: "Königin Camilla eröffnet größtes Kunstzentrum Großbritanniens",
          content: "Königin Camilla hat das neue British Centre for Contemporary Arts in Birmingham eröffnet, das mit einer Investition von 120 Millionen Pfund zum größten Kunstzentrum des Landes wird. Das spektakuläre Gebäude beherbergt Ausstellungsräume, Künstlerateliers und ein innovatives Bildungszentrum. Bei der Eröffnung betonte die Königin die Bedeutung der Kunst für den gesellschaftlichen Zusammenhalt. Das Zentrum wird jährlich bis zu eine Million Besucher erwarten.",
          source: "The Times",
          date: new Date().toISOString().split('T')[0],
          featured: false,
          isAutoGenerated: true
        }
      ];
    }

    // HAUPTDATEN LADEN
    async function loadAllData() {
      console.log("🔄 Lade alle Daten...");
      
      const timestamp = new Date().getTime();
      const url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRB56yMX7C4q-o3tDU4dVZGxive_c-x84aii2HXnI1RULRdYKqloZ9JtKcFHe0TXsmPbJOEOqZDtZUb/pub?output=tsv';
      
      // Elemente finden
      const reminders = document.getElementById("reminders");
      const note = document.getElementById("note");
      const newsContainer = document.getElementById("news-container");
      
      if (!reminders || !note || !newsContainer) {
        console.error("❌ Wichtige Elemente nicht gefunden");
        return;
      }
      
      // Leeren
      reminders.innerHTML = "";
      note.innerHTML = "";
      newsContainer.innerHTML = "";
      
      const articles = [];
      const today = new Date().toISOString().split("T")[0];
      
      try {
        // Google Sheets laden
        console.log("📊 Lade Google Sheets...");
        
        const response = await fetch('https://api.allorigins.win/raw?url=' + encodeURIComponent(url) + '&timestamp=' + timestamp);
        
        if (response.ok) {
          const text = await response.text();
          
          if (text && text.trim() !== '') {
            const rows = text.trim().split('\n').map(row => row.split('\t'));
            console.log(`📋 ${rows.length} Zeilen in Google Sheets gefunden`);

            rows.forEach((row) => {
              if (!row || row.length < 2) return;
              
              const type = row[0];
              const content = row[1];
              const sender = row[2] || "";
              const rawDate = row[3] || row[2];
              const timestamp = row[4];
              const extra1 = row[5] || "";
              const extra2 = row[6] || "";
              const extra3 = row[7] || "";
              
              if (!type || !content) return;

              let isToday = false;
              try {
                isToday = !rawDate || new Date(rawDate).toISOString().split("T")[0] === today;
              } catch (e) {
                isToday = !rawDate;
              }

              // ERINNERUNGEN
              if (type === "Erinnerung" && isToday) {
                const li = document.createElement("li");
                li.textContent = "🔔 " + content;
                reminders.appendChild(li);
              }

              // NACHRICHTEN VON SÖHNEN
              if (type === "Nachricht") {
                const messageWrapper = document.createElement("div");
                messageWrapper.className = "message-with-avatar";
                
                if (sender) {
                  const avatarDiv = document.createElement("div");
                  avatarDiv.className = "message-avatar";
                  
                  const avatarImg = document.createElement("img");
                  avatarImg.src = senderImages[sender] || `https://ui-avatars.com/api/?name=${sender.charAt(0)}&background=777&color=fff`;
                  avatarImg.alt = sender;
                  avatarImg.onerror = function() {
                    this.src = `https://ui-avatars.com/api/?name=${sender.charAt(0)}&background=777&color=fff&size=100`;
                  };
                  
                  avatarDiv.appendChild(avatarImg);
                  messageWrapper.appendChild(avatarDiv);
                  
                  const contentDiv = document.createElement("div");
                  contentDiv.className = "message-content";
                  
                  // Datum parsen
                  let messageDate = new Date();
                  if (timestamp && timestamp.trim()) {
                    try {
                      messageDate = new Date(timestamp.trim());
                      if (isNaN(messageDate.getTime())) {
                        messageDate = new Date();
                      }
                    } catch (e) {
                      messageDate = new Date();
                    }
                  }

                  // Neu-Indikator
                  const now = new Date();
                  const fiveHoursAgo = new Date(now.getTime() - 5 * 60 * 60 * 1000);
                  const isReallyNew = messageDate > fiveHoursAgo;
                  
                  if (isReallyNew) {
                    const newIndicator = document.createElement("div");
                    newIndicator.className = "new-indicator";
                    newIndicator.textContent = `Neu von ${sender}`;
                    contentDiv.appendChild(newIndicator);
                  } else {
                    const senderDiv = document.createElement("div");
                    senderDiv.className = "message-sender";
                    senderDiv.textContent = sender;
                    contentDiv.appendChild(senderDiv);
                  }
                  
                  const p = document.createElement("p");
                  p.className = "message";
                  p.innerHTML = linkifyText(content);
                  
                  const ts = document.createElement("div");
                  ts.className = "message-timestamp";
                  
                  let datePrefix = "";
                  const yesterday = new Date();
                  yesterday.setDate(yesterday.getDate() - 1);
                  
                  if (messageDate.toDateString() === new Date().toDateString()) {
                    datePrefix = "Heute";
                  } else if (messageDate.toDateString() === yesterday.toDateString()) {
                    datePrefix = "Gestern";
                  } else {
                    datePrefix = messageDate.toLocaleDateString('de-DE', {
                      day: '2-digit', month: '2-digit', year: '2-digit'
                    });
                  }

                  ts.textContent = `${datePrefix}, ${messageDate.toLocaleTimeString('de-DE', {
                    hour: '2-digit', minute: '2-digit', hour12: false
                  })}`;
                  
                  p.appendChild(ts);
                  contentDiv.appendChild(p);
                  messageWrapper.appendChild(contentDiv);
                  
                  note.appendChild(messageWrapper);
                }
              }

              // MANUELLE PRESSEARTIKEL
              if (type === "Presseartikel") {
                const article = {
                  title: sender,
                  content: content,
                  subtitle: extra1 || "",
                  source: extra2 || "Redaktion",
                  date: rawDate || new Date().toISOString().split("T")[0],
                  featured: extra3.toLowerCase() === "ja",
                  isAutoGenerated: false
                };
                
                if (isArticleAcceptable(article.title, article.content, article.subtitle)) {
                  articles.push(article);
                  console.log(`✅ Manueller Artikel: ${article.title.substring(0, 30)}...`);
                }
              }
            });
            
            console.log("✅ Google Sheets verarbeitet");
          }
        } else {
          console.log("⚠️ Google Sheets nicht verfügbar");
        }
        
        // AUTOMATISCHE ARTIKEL HINZUFÜGEN
        const autoArticles = getAutoArticles();
        articles.push(...autoArticles);
        console.log(`📰 ${autoArticles.length} automatische Artikel hinzugefügt`);
        
        // ARTIKEL ANZEIGEN
        if (articles.length > 0) {
          articles.sort((a, b) => {
            if (a.featured && !b.featured) return -1;
            if (!a.featured && b.featured) return 1;
            return new Date(b.date) - new Date(a.date);
          });

          articles.forEach(article => {
            const articleElement = document.createElement("article");
            articleElement.className = article.featured ? "news-article featured" : "news-article";
            
            const readingTime = estimateReadingTime(article.content);
            const formattedDate = new Date(article.date).toLocaleDateString('de-DE', {
              day: '2-digit', month: 'long', year: 'numeric'
            });

            const autoTag = article.isAutoGenerated ? ' 🤖' : '';

            articleElement.innerHTML = `
              <div class="news-header">
                <span class="news-source">${article.source}${autoTag}</span>
                <div class="news-meta">
                  <span class="news-date">${formattedDate}</span>
                  <span class="news-reading-time">${readingTime}</span>
                </div>
              </div>
              <h2 class="news-title">${article.title}</h2>
              ${article.subtitle ? `<h3 class="news-subtitle">${article.subtitle}</h3>` : ''}
              <div class="news-content">
                ${article.content.split('\n').map(paragraph => 
                  paragraph.trim() ? `<p>${paragraph.trim()}</p>` : ''
                ).join('')}
              </div>
              <div class="news-byline">${article.isAutoGenerated ? 'Automatisch kuratiert' : 'Redaktionsteam'}</div>
            `;
            
            newsContainer.appendChild(articleElement);
          });
          
          console.log(`✅ ${articles.length} Artikel angezeigt`);
        } else {
          newsContainer.innerHTML = `
            <div class="no-articles-message">
              <p>📰 Keine Artikel verfügbar.</p>
            </div>
          `;
        }
        
        // ERINNERUNGEN FALLBACK
        if (reminders.children.length === 0) {
          reminders.innerHTML = "<em>Keine Erinnerungen für heute.</em>";
        }
        
        console.log("✅ Alle Daten geladen");
        
      } catch (error) {
        console.error("❌ Fehler beim Laden:", error);
        
        // Automatische Artikel als Fallback
        const autoArticles = getAutoArticles();
        autoArticles.forEach(article => {
          const articleElement = document.createElement("article");
          articleElement.className = article.featured ? "news-article featured" : "news-article";
          
          const readingTime = estimateReadingTime(article.content);
          const formattedDate = new Date(article.date).toLocaleDateString('de-DE', {
            day: '2-digit', month: 'long', year: 'numeric'
          });

          articleElement.innerHTML = `
            <div class="news-header">
              <span class="news-source">${article.source} 🤖</span>
              <div class="news-meta">
                <span class="news-date">${formattedDate}</span>
                <span class="news-reading-time">${readingTime}</span>
              </div>
            </div>
            <h2 class="news-title">${article.title}</h2>
            <div class="news-content">
              ${article.content.split('\n').map(paragraph => 
                paragraph.trim() ? `<p>${paragraph.trim()}</p>` : ''
              ).join('')}
            </div>
            <div class="news-byline">Automatisch kuratiert</div>
          `;
          
          newsContainer.appendChild(articleElement);
        });
        
        reminders.innerHTML = "<em>Daten werden geladen...</em>";
        note.innerHTML = "<em>Nachrichten werden geladen...</em>";
      }
    }

    // KALENDER LADEN
    async function loadCalendar() {
      console.log("📅 Lade Kalender...");
      
      const icalUrl = 'https://calendar.google.com/calendar/ical/c07e2a0992894595b6591a5831830abaebefa4287e71915cf353e078fc21cb54@group.calendar.google.com/public/basic.ics';
      const proxies = ['https://api.allorigins.win/raw?url=', 'https://corsproxy.io/?'];
      
      for (const proxy of proxies) {
        try {
          const response = await fetch(proxy + encodeURIComponent(icalUrl));
          if (!response.ok) continue;
          
          const data = await response.text();
          if (!data.includes('BEGIN:VCALENDAR')) continue;
          
          const comp = new ICAL.Component(ICAL.parse(data));
          const allEvents = comp.getAllSubcomponents('vevent').map(e => new ICAL.Event(e));

          const today = new Date();
          today.setHours(0, 0, 0, 0);
          const in2Days = new Date(today);
          in2Days.setDate(today.getDate() + 2);
          in2Days.setHours(23, 59, 59, 999);

          const events = allEvents
            .filter(e => {
              try {
                const startDate = e.startDate.toJSDate();
                return startDate >= today && startDate <= in2Days;
              } catch (err) {
                return false;
              }
            })
            .sort((a, b) => a.startDate.toJSDate() - b.startDate.toJSDate());

          const out = document.getElementById("ical");
          if (out) {
            if (events.length === 0) {
              out.innerHTML = "<em>Keine bevorstehenden Termine.</em>";
            } else {
              out.innerHTML = "";
              events.forEach(e => {
                try {
                  const d = e.startDate.toJSDate();
                  const isAllDay = e.startDate.isDate;
                  const box = document.createElement("div");
                  box.className = "termin-eintrag";
                  box.textContent = `📅 ${d.toLocaleDateString('de-DE', {
                    weekday: 'long', day: '2-digit', month: '2-digit'
                  })}` + (isAllDay ? ` – ${e.summary}` : `, ${d.toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' })} – ${e.summary}`);
                  out.appendChild(box);
                } catch (err) {
                  console.error("Fehler bei Event:", err);
                }
              });
            }
            console.log("✅ Kalender geladen");
          }
          return;
        } catch (error) {
          console.log(`Kalender-Proxy ${proxy} fehlgeschlagen`);
        }
      }
      
      const out = document.getElementById("ical");
      if (out) {
        out.innerHTML = "<em>Termine werden geladen...</em>";
      }
    }

    // BATTERIE PRÜFEN
    function checkBattery() {
      if (typeof fully !== 'undefined') {
        const batteryLevel = fully.getBatteryLevel();
        const isPluggedIn = fully.isPlugged();
        const warningElement = document.getElementById('battery-warning');
        const percentageElement = document.getElementById('battery-percentage');
        
        if (percentageElement) percentageElement.textContent = batteryLevel;
        
        if (warningElement) {
          if (batteryLevel <= 30 && !isPluggedIn) {
            warningElement.classList.remove('hidden');
          } else {
            warningElement.classList.add('hidden');
          }
        }
      } else if (navigator.getBattery) {
        navigator.getBattery().then(function(battery) {
          const level = Math.floor(battery.level * 100);
          const percentageElement = document.getElementById('battery-percentage');
          const warningElement = document.getElementById('battery-warning');
          
          if (percentageElement) percentageElement.textContent = level;
          
          if (warningElement) {
            if (level <= 30 && !battery.charging) {
              warningElement.classList.remove('hidden');
            } else {
              warningElement.classList.add('hidden');
            }
          }
        });
      }
    }

    // INITIALISIERUNG UND UPDATES
    document.addEventListener('DOMContentLoaded', function() {
      console.log("🎯 DOM geladen - starte Initialisierung...");
      
      // Sofort ausführen
      initDateTime();
      loadWeather();
      loadAllData(); 
      loadCalendar();
      checkBattery();
      
      // Regelmäßige Updates
      setInterval(updateClock, 60000);           // Uhrzeit jede Minute
      setInterval(loadAllData, 30000);           // Daten alle 30 Sekunden  
      setInterval(loadWeather, 300000);          // Wetter alle 5 Minuten
      setInterval(loadCalendar, 600000);         // Kalender alle 10 Minuten
      setInterval(checkBattery, 30000);          // Batterie alle 30 Sekunden
      
      console.log("✅ Alle Updates gestartet!");
    });

  </script>

</body>
</html>
